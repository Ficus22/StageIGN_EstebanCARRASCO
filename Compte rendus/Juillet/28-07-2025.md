---
tags:
  - note-quotidienne
Auteur: Esteban Carrasco
Fichier mère: "[[Compte rendus - Juillet]]"
---

> [!todo]+ To do list
> - [ ] trajectoire avec DeepSORT


## Réalisé
- génération de [[DeepSORT2.mp4]] avec [[adaptation.py]] : essaie du code original [[original.py]] adapté avec les bons noms de variables

- génération de [[DeepSORT3.mp4]] avec [[adaptation.py]] : suppresion des seuils de confiance
- génération de [[DeepSORT4.mp4]] avec [[adaptation.py]] : modification des hypermètres du tracker et ajout du chrono
```python
tracker = DeepSort(
    max_iou_distance=0.3,
    gating_only_position=True,          
    max_cosine_distance=0.1,            
    max_age=15,                         
    n_init=5,                          
    nms_max_overlap=0.8,
    nn_budget=220,                      
    embedder='mobilenet',               
    embedder_gpu=True,
    polygon=False,  
)
```

- génération de [[DeepSORT5.mp4]] avec [[adaptation.py]] :lorsque deux boxs matchent, on utilise les coordonnées originales
```python
x, y, w, h = map(int, track.to_ltwh(orig=True))
```

- génération de [[DeepSORT6.mp4]] avec [[adaptation.py]] : modification du filtre de kalman [[Programmes/venv/lib/python3.12/site-packages/deep_sort_realtime/deep_sort/kalman_filter.py|kalman_filter.py]] dans la librairie pour qu'il soit moins confiant. Re-modification des hyperparamètres (`nn_budget=150`, `max_age=20`, `n_init=10`)
```python
self._std_weight_position = 1. / 40   # à la place de 20
self._std_weight_velocity = 1. / 200  # à la place de 160
```

- génération de [[DeepSORT7.mp4]] avec [[adaptation.py]] : remplacement des bbox du tracker par une croix et supression de la modif ajouté à [[DeepSORT5.mp4]]
```python
        x, y, w, h = map(int, track.to_ltwh()) 
        cv2.putText(frame, label, (x, y),
                    cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 0, 255), 2)
        label = f"ID: {track_id}"
        cv2.putText(frame, label, (x+30, y - 30),
                    cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 0, 255), 2)
```

- Abandon de DeepSORT et recherche sur ByteTrack

---
## Problèmes
- [[DeepSORT2.mp4]] : seuil de confiance trop haut et suivie mauvais. 
- [[DeepSORT3.mp4]] : les bbox des tracker ont leur top left corner sur le centre des bbox prédite. Suivie qui a l'air en moyenne acceptable.
- [[DeepSORT4.mp4]] : pas de différence signicative. Le problème pour le décallage des bbox vient du filtre de Kalman qui prédit des positions de boîtes légèrement décalées, car ses paramètres donnent trop de poids aux prédictions (490s)
- [[DeepSORT5.mp4]] : pareil voir pire (490s)
- [[DeepSORT6.mp4]] : pareil (450s)
- [[DeepSORT7.mp4]] : pareil (446s)