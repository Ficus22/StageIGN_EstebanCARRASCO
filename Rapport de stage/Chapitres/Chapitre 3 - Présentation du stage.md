5-10 pages
## Contextualisation
Les abeilles peuvent communiquer à leurs congénères l'emplacement des ressources intéressantes à butiner en exécutant ce que l'on appelle une danse frétillante. La possibilité de décoder précisément les informations transmises à travers ces danses aiderait les biologistes, les écologistes, les apiculteurs et même les décideurs à limiter le déclin actuel des abeilles. 

Dans le cadre de cette étude une thèse, financé par l'OFB dans le cadre du plan *Ecophyto*, a été développé. Cette recherche mené par Sylvain Galopin, dirigée par Guillaume Touya (IGN) et Freddie-Jeanne Richard (INRAE) a conduit au développement de la GeoDanceHive. 

La GeoDanceHive est une ruche expérimentale conçue pour étudier de manière automatisée et non intrusive le comportement des abeilles, notamment leurs danses frétillantes, aussi appelée *waggle dance*. Cette ruche est en réalité le résultat de l'assemblage de deux ruche dont une "vide" faisant office de "studio". Ce studio permet de filmer et d’analyser les mouvements des abeilles sur le premier cadre, sans perturber leur activité normale ni nuire à la production de miel. Il intègre un système de caméras haute résolution, un éclairage LED UV, ainsi qu’un mini-ordinateur embarqué d'un algorithme de vision par ordinateur capable de détecter et de traiter les séquences de danse.

L’objectif de ce dispositif est de mieux comprendre les dynamiques de butinage, d’identifier les ressources florales exploitées par les colonies, et de fournir aux chercheurs des données précises sur les interactions entre les abeilles et leur environnement. Elle offre ainsi un outil utile au suivi écologique des paysages, la préservation des pollinisateurs et l’optimisation des pratiques apicoles.

Pour comprendre l’intérêt d’un tel dispositif, il est essentiel de s’attarder sur les modes de communication des abeilles. L’abeille mellifère utilise une forme de langage corporel particulièrement élaborée pour transmettre à ses congénères des informations sur l’emplacement des ressources. Lorsqu’une butineuse découvre une source de nourriture qu’elle juge intéressante, elle retourne à la ruche et exécute une danse spécifique sur les rayons, dans l’obscurité, au contact des autres abeilles, ce sont les danse frétillantes. Une danse frétillante se compose d’un mouvement en boucle en forme de 8, dont la section centrale, où l’abeille frétille en ligne droite, contient les informations essentielles. L’orientation de cette ligne droite par rapport à la verticale indique la direction de la ressource par rapport au soleil, tandis que la durée de frétillement donne une indication sur la distance à parcourir. Cette danse encodée constitue l’un des rares exemples connus de langage symbolique chez un animal non humain. En plus de ce langage corporel, les abeilles utilisent également des signaux chimiques, appelés phéromones, pour transmettre d’autres types d’informations. Ces substances jouent un rôle central dans la cohésion sociale de la colonie, la régulation des tâches et la communication de signaux d’alarme ou d’identification. 

Enfin, des contacts physiques, des échanges de nourriture et des vibrations complètent ce système de communication complexe, qui permet à la colonie d’agir de manière coordonnée et adaptative face à son environnement. La compréhension de ces modes de communication est au cœur de l’intérêt porté au développement d'outils comme la GeoDanceHive, qui permettent d’étudier ces interactions précieuses à grande échelle et sur des périodes prolongées.

## Problématique
Il est de connaissance commune que les ruches se situent rarement a proximité de serveur de calcul ou même d'arrivé électrique. C'est pourquoi il est nécessaire afin de faciliter son déploiement, que la GDH soit autonome et embarquable. Mais comment rendre embarquable un système fonctionnant sur la base d'un algorithme gourmand en temps et en calcul, puisque qu'il nécessite 4min pour analyser 10min de vidéo lorsqu'il est lancé sur un ordinateur ? Comment parvenir à implémenter une analyse en temps réel sur un micro ordinateur ? 

## Objectif du stage
C'est à la suite de cette problématique que le sujet de mon stage est alors apparu nécessaire. C'est pourquoi l'objectif de mon stage est d'entamer des recherches sur des solutions à cette problématique. 
Ainsi, ma mission lors de ce stage a été de développer un modèle d'apprentissage profond capable de détecter certains comportements spécifiques des abeilles comme les danses frétillantes. Du moins c'est l'intention que j'avais en amorçant mes premiers jours de travail. Les objectifs ont néanmoins été très rapidement réajusté par Mr Touya, qui m'a expliqué que patience et longueur de temps sont de rigueur dans la recherche. Effectivement, il est inenvisageable ou utopique d'espérer aboutir à un modèle fonctionnel en seulement 4 mois. C'est pourquoi l'une de mes premières missions fut d'entamer des recherches préliminaires, après un état d'art du projet, dans le but de dresser un plan de route et des objectifs réalistes. 

## Plan de route 
Alors le 7 mai, après une semaine et demis de recherche et d'assimilation du projet, je dressai ce pipeline que Mr Touya approuva. Néanmoins, il  me mit en garde quand au fait que je n'arriverai très certainement pas au terme de cette pipeline dans les temps incombant mon stage. "Tu risque de passer tout ton stage sur la première étape, mais c'est ok !" me dit-il lors d'une réunion hebdomadaire, remarque que j'ai d'abord pris à la dérision, convaincu que je parviendrai a aller au bout. C'est seulement quelques jours après que j'ai saisie la véracité de ce propos. Effectivement, bien que pleins de bonnes intentions, mais ne connaissant rien à l'univers de la recherche, je risquais de passer tout mon stage sur cette première étape. 
Dans l'unique but de préserver le suspense de ce rapport, je ne dévoilerai pas ici, si je suis parvenu à avancer plus loin que cette étape une. 

Voici donc le pipeline originel dressé à la genèse de ce stage.

![[Pasted image 20250718094612.png]]

Détaillons brièvement l'anatomie de ce pipeline. Dans cette forme là, il s'agit de sa première version, on verra par la suite que cette dernière a quelque peu évolué tout au long de mon stage. 

#### Etape 1 - YOLO Abeilles
Dans cette première étape l'idée est de détecter le plus d'abeilles individuellement. Ici on fait fi de la position des abeille ou même de leur comportement. Le but est de faire un détectage de masse que l'on discrétisera ensuite à travers les prochaines étapes.  
Pour se faire, je prévois d'utiliser un modèle d'apprentissage profond déjà entrainé une sur une importante quantité d'image, il s'agit de YOLOv10. L'enjeu ici est donc de parvenir à réentraîner et fine-tuner le modèle pour qu'il reconnaisse les abeilles de la GDH. 

#### Etape 2 - Deep sort
Une fois les bounding box de la majorité des individus obtenue, l'objectif dans cette étape, et d'utiliser Deep Sort pour faire un tracé des trajectoires de ces abeilles détectées. Ainsi chacune de nos polinisatrices auraient un identifiant propre, ce qui nous permettrai alors d'installer une logique de suivie à travers les frames d'une vidéo. Ainsi nous serions en mesure de tracer les trajectoires de leur box, ou tout du moins de les récupérer. 

> [!info] Deep SORT
> Deep SORT (Simple Online and Realtime Tracking with a Deep Association Metric) est un algorithme de suivi d’objets en temps réel qui améliore le système SORT original en y intégrant une composante d’apprentissage profond. Alors que SORT utilise uniquement les données de position et de mouvement (comme les boîtes englobantes et la vélocité) pour suivre les objets d’une image à l’autre, Deep SORT ajoute une dimension d’analyse visuelle en extrayant des descripteurs d’apparence via un réseau de neurones convolutifs. Concrètement, chaque objet détecté est associé à une empreinte visuelle, ce qui permet de le reconnaître plus facilement même s’il disparaît temporairement ou subit une occlusion. Le système combine ces informations avec un filtre de Kalman pour prédire la position future de chaque objet, et utilise l’algorithme de Hongrie pour résoudre le problème d’association entre détections et trajectoires existantes. En croisant les données de mouvement et d’apparence, Deep SORT améliore la robustesse du suivi multi-objets, en particulier dans des scènes complexes où les objets peuvent se croiser ou se ressembler visuellement.

#### Etape 3 - YOLO Trajectoires
À partir des coordonnées extraites via le suivi Deep SORT, il devient possible de reconstruire visuellement les trajectoires des abeilles sous forme d’images binaires (noir et blanc), où les tracés représentent leurs déplacements au fil du temps. Ce type de représentation simplifiée permettrait de repérer visuellement certaines formes caractéristiques, notamment la fameuse trajectoire en "8" associée à la danse frétillante. L’orientation de cette boucle par rapport à la verticale de l’image peut être exploitée pour déterminer l’angle de la danse, tandis que la **longueur du segment central** (la phase de frétillement) donnerait une indication sur la distance annoncée, à condition de connaître le nombre d’images sur lequel elle s’étale.

À partir de ces images synthétiques, plusieurs stratégies peuvent être envisagées. L’une consiste à entraîner un modèle comme YOLOv10 spécifiquement pour la reconnaissance des formes de trajectoires caractéristiques des danses. Une autre approche, peut-être plus adaptée à la nature binaire et moins complexe des images, serait de recourir à un modèle de segmentation comme U-Net, capable de détecter des motifs spatiaux même dans des contextes visuellement simples. Le choix du modèle revient en quelque sorte à décider entre utiliser un bulldozer ou une pelle pour creuser un château de sable : tout dépend de la précision, de la consommation de ressources et du niveau de généralisation attendu.

Quoi qu’il en soit, cette étape vise à produire une première reconnaissance automatique des danses frétillantes, en extrayant les motifs correspondant au comportement recherché. Les résultats obtenus resteront probablement imparfaits à ce stade : du bruit, des faux positifs et des trajectoires incomplètes sont à prévoir.

#### Etape 4 - LSTM Découpage
C’est à cette étape que l’usage du **LSTM (Long Short-Term Memory)** prend tout son sens. Ce type de réseau neuronal récurrent est particulièrement adapté au traitement de séquences temporelles, comme celles issues des trajectoires de nos abeilles. Son rôle ici serait de découper les trajectoires complètes en segments pertinents, en identifiant précisément les moments où commence et se termine les danses.

Contrairement aux approches basées uniquement sur des caractéristiques visuelles statiques, le LSTM peut prendre en compte la dynamique du mouvement : accélérations, virages, répétitions rythmiques, etc. Il apprend à reconnaître des motifs temporels récurrents qui signalent une danse, même lorsque celle-ci est partiellement masquée ou perturbée par du bruit. On pourrait lui fournir en entrée une séquence de positions (ou leur représentation visuelle dans une série d’images) et lui demander de produire un signal binaire indiquant la présence ou non d’une danse sur chaque intervalle temporel.

Ce découpage affinerait donc la détection brute de l’étape précédente, en filtrant les faux positifs et en localisant précisément les danses effectives dans la vidéo.

#### Etape 5 - CNN Nettoyage ?
Cette étape s'arbore d'un point d'interrogation car à ce stade je ne sais dire si elle est nécessaire ou si le LSTM dans sa performance annihilera son existence. Mais dans l'idée, une fois les séquences candidates extraites et découpées, il reste encore à valider, nettoyer et affiner les détections. C’est là qu’intervient un réseau convolutif (CNN), utilisé ici comme un filtre final ou comme un classifieur binaire chargé de confirmer (ou non) la présence d’une danse frétillante. Ce modèle pourrait être entraîné sur un ensemble de séquences annotées pour éliminer les fragments ambigus, incomplets ou trop bruyants, et pour garantir un certain niveau de confiance dans les détections retenues.

L’objectif n’est pas forcément de faire une classification exhaustive, mais plutôt de nettoyer les résultats précédents en éliminant les erreurs résiduelles et en s’assurant que seules les trajectoires vraiment caractéristiques soient conservées pour l’analyse finale.

### Conclusion du chapitre
Désormais nous avons en main les bases scientifiques, techniques et méthodologiques du projet dans lequel s’inscrit mon stage. En recontextualisant les enjeux liés à l’étude des danses frétillantes des abeilles, en présentant la GeoDanceHive et en exposant la problématique de son embarquabilité, nous avons pu cerner les contours d’un défi mêlant à la fois biologie comportementale, vision par ordinateur, et contraintes matérielles de terrain. Ce qui m'offre l'occasion de rappeler que bien que ce stage ne se profilait dans mes intérets il a merveilleusement su le soliciter. 

Le pipeline théorique détaillé ici illustre l’ambition du projet, mais aussi sa complexité. Il constitue une feuille de route précieuse, sur laquelle s’est appuyée la totalité de mon travail. Car, bien qu’il ait été conçu dans l’enthousiasme des premiers jours, il s’est heurté à la réalité du temps, des moyens, et des aléas inhérents à tout travail de recherche.

Dans le chapitre suivant, nous aurons l'occasion de nous pencher plus profondément sur le déroulé de mon stage, en abordant les choix techniques, les expérimentations, les obstacles rencontrés, les ajustements effectués… et peut-être les surprises qui ont ponctué cette aventure scientifique.